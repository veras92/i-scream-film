{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,S,uCAOA,MAWMC,EAAMC,EAAAC,QAASC,cAXE,CACrBC,OAAQ,0CACRC,WAAY,kCACZC,UAAW,kBACXC,cAAe,8BACfC,kBAAmB,eACnBC,MAAO,4CAEPC,YAAa,wDAKTC,EAAeC,SAASC,cAAc,sBACtCC,EAAaF,SAASC,cAAc,oBAW1CE,eAAeC,EAAaC,EAAQC,GAClC,IACE,MAAMC,GAAW,EAAArB,EAAAsB,aAAYpB,GACvBqB,GAAY,EAAAvB,EAAAwB,KAAIH,EAAU,GAAGF,KAAUC,KAEvCK,SADuB,EAAAzB,EAAA0B,KAAIH,IACHI,MAC9B,GAAIF,EAAQ,CACV,MAAMG,EAAcC,OAAOC,OAAOL,GAIlC,OASNR,eAAwBc,GACtB,MAAMC,EAAW,IAAI,EAAAC,EAAAC,UACfC,QAAiBC,QAAQC,IAC7BN,EAAYO,KAAIC,GAAMP,EAASQ,YAAYD,MAI7CE,QAAQC,IAAIP,E,CAlBCQ,CAAAf,GACTa,QAAQC,IAAId,GACLA,C,CAEP,MAAO,E,CAET,MAAOgB,GACPH,QAAQG,MAAMA,E,EAclB,SAASC,EAAUzB,IACJ,EAAA0B,EAAAC,WAERC,oBAAmBC,IACtB,GAAIA,EAAM,CAER/B,EADe+B,EAAKC,IACC9B,E,KA7C3BP,EAAasC,iBAAiB,SAG9B,WACEN,EAAU,U,IAHZ7B,EAAWmC,iBAAiB,SAK5B,WACEN,EAAU,Q","sources":["src/js/test-library.js"],"sourcesContent":["import { getDatabase, ref, get } from 'firebase/database';\r\n\r\nimport { getAuth } from 'firebase/auth';\r\nimport firebase from 'firebase/compat/app';\r\nimport { FimlsApi } from './film-service';\r\n\r\n// const database = getDatabase(app);\r\nconst firebaseConfig = {\r\n  apiKey: 'AIzaSyA8HI-hGo7_WkrdYi4nAbp8aOc6TTRuWvY',\r\n  authDomain: 'filmoteka-c3101.firebaseapp.com',\r\n  projectId: 'filmoteka-c3101',\r\n  storageBucket: 'filmoteka-c3101.appspot.com',\r\n  messagingSenderId: '990735444623',\r\n  appId: '1:990735444623:web:5585f899cc012270841efa',\r\n\r\n  databaseURL: 'https://filmoteka-c3101-default-rtdb.firebaseio.com',\r\n};\r\n\r\nconst app = firebase.initializeApp(firebaseConfig);\r\n\r\nconst btnWatchedEl = document.querySelector('.js-watched-button');\r\nconst btnQueueEl = document.querySelector('.js-queue-button');\r\n\r\nbtnWatchedEl.addEventListener('click', onClickWatchedBtn);\r\nbtnQueueEl.addEventListener('click', onClickQueueBtn);\r\n\r\nfunction onClickWatchedBtn() {\r\n  getUserId('watched');\r\n}\r\nfunction onClickQueueBtn() {\r\n  getUserId('queue');\r\n}\r\nasync function getDataArray(userId, action) {\r\n  try {\r\n    const database = getDatabase(app);\r\n    const moviesRef = ref(database, `${userId}/${action}`);\r\n    const moviesSnapshot = await get(moviesRef);\r\n    const movies = moviesSnapshot.val();\r\n    if (movies) {\r\n      const moviesArray = Object.values(movies);\r\n      //тут масив з id\r\n      getFilms(moviesArray);\r\n      console.log(moviesArray);\r\n      return moviesArray;\r\n    } else {\r\n      return [];\r\n    }\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\nasync function getFilms(filmsIdsArr) {\r\n  const filmsApi = new FimlsApi();\r\n  const filmsArr = await Promise.all(\r\n    filmsIdsArr.map(id => filmsApi.getFilmById(id))\r\n  );\r\n\r\n  // filmsArr масив з інфою про фільми\r\n  console.log(filmsArr);\r\n}\r\n\r\nfunction getUserId(action) {\r\n  const auth = getAuth();\r\n\r\n  auth.onAuthStateChanged(user => {\r\n    if (user) {\r\n      const userId = user.uid;\r\n      getDataArray(userId, action);\r\n    }\r\n  });\r\n}\r\n"],"names":["$jAzyG","parcelRequire","$67e7180826cb6a14$var$app","$cEmXr","default","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","databaseURL","$67e7180826cb6a14$var$btnWatchedEl","document","querySelector","$67e7180826cb6a14$var$btnQueueEl","async","$67e7180826cb6a14$var$getDataArray","userId","action","database","getDatabase","moviesRef","ref","movies","get","val","moviesArray","Object","values","filmsIdsArr","filmsApi","$6meQU","FimlsApi","filmsArr","Promise","all","map","id","getFilmById","console","log","$67e7180826cb6a14$var$getFilms","error","$67e7180826cb6a14$var$getUserId","$eyjy7","getAuth","onAuthStateChanged","user","uid","addEventListener"],"version":3,"file":"library.6a67ce60.js.map"}